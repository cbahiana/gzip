"use strict;";"{IMPORT_SCRIPTS}";const e=null,t=Object.create(e);!function(){const s={implement(e){const t=e.prototype,s=[].slice.call(arguments,1);let n,o,i;function a(e,t,s){return function(){const r="previous"in this,n="parent"in this,o=this.previous,i=this.parent;this.previous=t,this.parent=s;const a=e.apply(this,arguments);return r&&(this.previous=o),n&&(this.parent=i),a}}for(n=0;n<s.length;n++)for(i in s[n])switch(typeof(o=s[n][i])){case"function":t[i]=a(o,e[i],t[i]);break;case"object":t[i]=r(!0,Array.isArray(o)?[]:{},o);break;default:t[i]=o}return e},merge:r,reset:function t(n){const o=s.getAllPropertiesName(n);let i,a,c=o.length;for(;c&&c--;)i=o[c],a=Object.getOwnPropertyDescriptor(n,i),n[i]!=e&&"object"==typeof n[i]&&a!=e&&"value"in a&&a.writable&&a.configurable&&(n[i]=r(!0,Array.isArray(n[i])?[]:{},t(n[i])));return n},extendArgs:e=>(function(t){if("object"==typeof t){const s=[].slice.call(arguments,1);let r;for(r in t)e.apply(this,[r,t[r]].concat(s))}else e.apply(this,arguments);return this}),getAllPropertiesName(e){const t=[];let s,r,n,o=e;do{for(s=Object.getOwnPropertyNames(o),n=0;n<s.length;n++)r=s[n],-1===t.indexOf(r)&&t.push(r)}while(o=Object.getPrototypeOf(o));return t}};function r(t){const s=[].slice.call(arguments,1);let n,o,i,a,c="boolean"==typeof t;for(!0===c&&(c=t,t=s.shift()),n=0;n<s.length;n++)if((o=s[n])!=e)for(i in o)switch(typeof(a=o[i])){case"object":t[i]=a!=e&&c?r(c,"object"==typeof t[i]&&t[i]!=e?t[i]:Array.isArray(a)?[]:{},a):a;break;default:t[i]=a}return t}t.Utils=s}(),function(){const s=t.Utils,r=s.extendArgs,n={$events:{},$pseudo:{},promisify:r(function(t,s,r){const n=this;if(s==e)return;let o,i;const a=t=t.toLowerCase(),c={fn:s,cb:s,name:t,original:t,parsed:[t]};if(-1!=t.indexOf(":")){const s=t.match(/([^:]+):([^(]+)(\(([^)]+)\))?/);s==e?c.name=t=t.split(":",1)[0]:(c.original=t,c.name=s[1],c.parsed=s,t=s[1],s[2]in n.$pseudo&&n.$pseudo[s[2]](c))}t in n.$events||(n.$events[t]=[]),o=n.$events[t].length;for(;o&&o--;)if((i=n.$events[t][o]).fn==s&&i.original==a)return;Object.defineProperty(c,"sticky",{value:!!r}),n.$events[t].push(c)}),off:r(function(e,t,s){const r=this;let n,o;e=e.toLowerCase().split(":",1)[0];const i=r.$events[e];if(void 0!=i){for(s=!!s,o=i.length;o&&o--;)n=i[o],(void 0!=t||s)&&(n.fn!=t||n.sticky&&n.sticky!=s)||r.$events[e].splice(o,1);0==i.length&&delete r.$events[e]}}),resolve(e){e=e.toLowerCase();const t=this,s=arguments.length>1?[].slice.call(arguments,1):[];return Promise.all((t.$events[e]||[]).concat().map(e=>new Promise(r=>{r(e.cb.apply(t,s))})))},addPseudo(e,t){return this.$pseudo[e]=t,this}};n.addPseudo("once",function(e){return e.cb=function(){const t=e.fn.apply(this,arguments);return this.off(e.name,e.fn),t},this}),t.PromiseEvent=n,s.merge(!0,t,n)}(),t.strategies=function(){const t=new Map,s={add:(e,r)=>t.set(e,{name:e,handle:async e=>{const t=await r(e);return t.type,e.request.mode,t.ok,t.bodyUsed,t&&t.type,s.isCacheableRequest(e.request,t),e.request.url,t&&t.url,t}}),keys:()=>t.keys(),values:()=>t.values(),entries:()=>t.entries(),get:e=>t.get(e),has:e=>t.has(e),delete:e=>t.delete(e),isCacheableRequest:(t,s)=>s!=e&&("cors"==s.type||new URL(t.url,self.origin).origin==self.origin)&&"GET"==t.method&&s.ok&&["default","cors","basic"].includes(s.type)&&!s.bodyUsed};return s[Symbol.iterator]=(()=>t[Symbol.iterator]()),Object.defineProperty(s,"size",{get:()=>t.size}),s}(),t.strategies.add("nf",async(s,r)=>{try{const r=await fetch(s.request);if(r==e)throw new Error("Network error");if(t.strategies.isCacheableRequest(s.request,r)){const e=r.clone();caches.open("{CACHE_NAME}").then(function(t){t.put(s.request,e)})}return r}catch(e){}return r.match(s.request)}),t.strategies.add("cf",async s=>{let r=await caches.match(s.request);if(r!=e)return r;if(r=await fetch(s.request),t.strategies.isCacheableRequest(s.request,r)){const e=r.clone();caches.open("{CACHE_NAME}").then(function(t){t.put(s.request,e)})}return r}),t.strategies.add("cn",async e=>{const s=await caches.match(e.request),r=fetch(e.request).then(function(s){if(t.strategies.isCacheableRequest(e.request,s)){const t=s.clone();caches.open("{CACHE_NAME}").then(function(s){s.put(e.request,t)})}return s});return s||r}),t.strategies.add("no",e=>fetch(e.request)),t.strategies.add("co",e=>caches.match(e.request)),function(t){function s(t){return t==e||"HEAD"==t?"GET":t.toLowerCase()}class r{constructor(){this.routes=Object.create(e),this.handlers=[],this.defaultHandler=Object.create(e)}getHandler(t,s){const r=s!=e&&s.request.method||"GET",n=this.routes[r]||[],o=n.length;let i,a=0;for(;o>a;a++)if((i=n[a]).match(t,s))return i.strategy,i.constructor.name,i.path,i.handler;return this.defaultHandler[r]}registerRoute(e,t){return(t=s(t))in this.routes||(this.routes[t]=[]),this.routes[t].push(e),this}unregisterRoute(e,t){t=s(t);const r=this.routes[t]||[],n=r.indexOf(e);return-1!=n&&r.splice(n,1),this}setDefaultHandler(e,t){this.defaultHandler[s(t)]=e}}class n{constructor(s,r){const n=this;t.Utils.reset(this),n.path=s,n.strategy=r.name,n.handler={handle:async t=>{let s,o,i=await n.resolve("beforeroute",t);for(s of i)if(s!=e&&s instanceof Response)return s;for(o of(s=await r.handle(t),i=await n.resolve("afterroute",t,s)))if(o!=e&&o instanceof Response)return o;return s}},n.promisify({beforeroute(e){"navigate"==e.request.mode&&[].slice.call(arguments)},afterroute(e,t){"navigate"==e.request.mode&&[].slice.call(arguments)}})}}t.Utils.merge(!0,n.prototype,t.PromiseEvent);const o=new r;r.RegExpRouter=class extends n{match(e){return/^https?:/.test(e)&&this.path.test(e)}},r.ExpressRouter=class extends n{constructor(e,t){super(e,t),this.url=new URL(e,self.origin)}match(e){const t=new URL(e);return/^https?:/.test(e)&&t.origin==this.url.origin&&0==t.pathname.indexOf(this.url.pathname)}},t.Router=r,t.router=o}(t);const s=t.strategies,r=t.Router,n=t.router;let o,i="{defaultStrategy}";for(o of"{exclude_urls}")n.registerRoute(new r.RegExpRouter(new RegExp(o),s.get("no")));for(o of"{network_strategies}")n.registerRoute(new r.RegExpRouter(new RegExp(o[1],"i"),s.get(o[0])));for(o of s)n.registerRoute(new r.ExpressRouter("{scope}/media/z/"+o[0]+"/",o[1]));s.has(i)||(i="no"),n.setDefaultHandler(s.get(i)),self.addEventListener("install",e=>{e.waitUntil(caches.open("{CACHE_NAME}").then(async e=>(await e.addAll("{preloaded_urls}"),self.skipWaiting())))}),self.addEventListener("activate",e=>{e.waitUntil(self.clients.claim().then(async()=>{const e=await caches.keys(),t="{CACHE_NAME}".split(/_/,2),s=2==t.length&&t[0]+"_";return Promise.all(e.map(e=>!1!==s&&0==e.indexOf(s)&&"{CACHE_NAME}"!=e&&caches.delete(e)))}))}),self.addEventListener("fetch",s=>{const r=t.router.getHandler(s.request.url,s);r!=e&&s.respondWith(r.handle(s).catch(e=>(console.error("ðŸ˜­",e),fetch(s.request))))});
