!function(){"use strict";async function e(e,t="id",n=[]){return new Promise((o,r)=>{const s=indexedDB.open(e,1),a=`${e}_store`;let i;const c=(e,t,n=null,o=null)=>new Promise((r,s)=>{const c=t?"readonly":"readwrite";if(i.objectStoreNames.contains(a)){const t=i.transaction(a,c),l=t.objectStore(a);let u;"put"===e&&n&&void 0!==n.length?(u=t,n.forEach(e=>{l.put(e)})):(o&&l.index(o),u=l[e](n)),u.oncomplete=(e=>{r(e.target.result)}),u.onsuccess=(e=>{r(e.target.result)}),u.onerror=(e=>{s(e)})}else s(Error("Store not found"))}),l={count:async()=>{const e=i.transaction(a,"readonly").objectStore(a).count();return new Promise(function(t,n){e.onsuccess=function(e){t(e.target.result)},e.onerror=function(e){n(e)}})},get:(e,t)=>c("get",!0,e,t),getAll:(e,t)=>c("getAll",!0,e,t),put:e=>c("put",!1,e),delete:e=>c("delete",!1,e),clear:()=>c("clear",!1),deleteDatabase:()=>new Promise(function(e,t){const n=indexedDB.deleteDatabase;n.onerror=t,n.onsuccess=e})};s.onupgradeneeded=(()=>{const e=(i=s.result).createObjectStore(a,{keyPath:t});let o;for(o of n)e.createIndex(o.name,o.key,o.options)}).bind(this),s.onsuccess=(()=>{i=s.result,o(l)}).bind(this),s.onerror=(e=>{r(Error(e.originalTarget&&e.originalTarget.error||e))}).bind(this)})}const t=(e,t)=>t instanceof Response&&("cors"==t.type||new URL(e.url,self.origin).origin==self.origin)&&"GET"==e.method&&t.ok&&["default","cors","basic","navigate"].includes(t.type)&&!t.bodyUsed,n=["method","referrer","referrerPolicy","mode","credentials","cache","redirect","integrity","keepalive"];function o(e=1){return e*=3600,function(t){return 1e3*Math.min(e,.5*(2**t-1))}}if("{BACKGROUND_SYNC}".enabled){const r=new class{async push(e){const t=await this.cloneRequestData(e),o=await this.getDB();return await o.put({id:function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return(+n).toString(36)}(e.url+n.map(async e=>{let n=t[e];return null==n?"":"headers"==e?n instanceof Headers?[...n.values()].filter(e=>null!=e).join(""):Object.values(n).map(n=>null!=t[e][n]?t[e][n]:"").join(""):"body"==e?await n.text():n}).join("")),lastRetry:Date.now()+864e5,url:e.url,request:t}),this}async cloneRequestData(e){const t={headers:{}};"GET"!==e.method&&(t.body=await e.clone().arrayBuffer());for(const[n,o]of e.headers.entries())t.headers[n]=o;for(const o of n)void 0!==e[o]&&(t[o]=e[o]);return"navigate"===t.mode&&(t.mode="same-origin"),t}async getDB(){return null==this.db&&(this.db=await e("gzip_sw_worker_sync_requests","id")),this.db}async replay(e){if("{SYNC_API_TAG}"!=e)return;const n=await this.getDB(),o=await n.getAll();o.length>0&&console.info("attempting to sync background requests ...");const r=await caches.open("{CACHE_NAME}");for(const e of o){let o=!1;try{console.info("attempting to replay background requests: ["+e.request.method+"] "+e.url);const n=new Request(e.url,e.request);let s=await r.match(n);(o=null!=s)||(o=null!=(s=await fetch(n.clone()))&&s.ok)&&t(n,s)&&await r.put(n,s)}catch(e){}!o&&e.lastRetry>Date.now()||await n.delete(e.id)}}};let s=0;const a=o();setTimeout(async function e(){await r.replay("{SYNC_API_TAG}"),setTimeout(e,a(++s))},a(s))}function r(e){let t,n=-1;const o=[].slice.apply(arguments).slice(1);return e.replace(/%([s%])/g,function(e,r){if("%"==r)return r;switch(t=o[++n],r){case"s":return null==t?"":t}})}!async function(){const t=await async function(){let t=await caches.open("{CACHE_NAME}");const n="{preloaded_urls}".map(e=>new URL(e,self.location).href),o="{pwa_cache_max_file_count}",s=await e("gzip_sw_worker_expiration_cache_private","url",[{name:"url",key:"url"},{name:"version",key:"version"},{name:"route",key:"route"}]);return async function(){let e=await s.count();if(e>o){console.info(r("cleaning up [%s] items present. [%s] items allowed",e,o));for(let a of await s.getAll())if(n.includes(a.url))console.info(r("skipped preloaded resource [%s]",a.url));else if(console.info(r("removing [%s]",a.url)),await t.delete(a.url),await s.delete(a.url),--e<=o)break;console.info(r("cleaned up [%s] items present. [%s] items allowed",e,o))}}}(),n=o();let s=0;setTimeout(async function e(){await t(),setTimeout(e,n(++s))},n(s))}()}();
