if("serviceWorker"in navigator){let e=document.createElement("script");e.async=!0,e.src="{worker-db}",e.onload=function(){let t,o=localforage.createInstance({name:"{worker-name}"}),n=navigator.serviceWorker,a=[],i="{worker-files}";o.config({driver:[localforage.INDEXEDDB,localforage.WEBSQL,localforage.LOCALSTORAGE]}),o.getItems(Object.keys(i)).then(function(e){for(let t in e)void 0!=e[t]&&e[t]!=i[t]&&a.push(e[t]);o.setItems(i).then(function(){n.register("{worker-location}").then(function(e){let n=e.installing||e.waiting||e.active;void 0!=n&&((i=Object.values(i)).length>0&&n.postMessage({action:"addFiles",files:i}),a.length>0&&n.postMessage({action:"removeFiles",files:a}),void 0!=(t="{worker-page}")&&o.getItem(t).then(function(e){(void 0==e||Date.now()-e>="{worker-max-age}")&&(n.postMessage({action:"removeFiles",files:[t]}),o.setItem(t,+new Date("{worker-date}")).then(function(){n.postMessage({action:"addFiles",files:[t]})}))}))}).catch(function(e){})})}),e.parentElement.removeChild(e)},document.head.appendChild(e)}
